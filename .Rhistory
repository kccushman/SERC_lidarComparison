abline(h=c(min(droneShot$Z-elevation),quantile(droneShot$Z-elevation,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1] + elevation),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1] - elevation),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-40,10),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(elevation,data_ha4_utmPoly_good$rh_98[1] + elevation),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
abline(h=c(elevation,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(elevation,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Elevation (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
elevation
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Elevation (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
droneShot <- readLAS("Data/GEDI/GEDI_example1.laz")
lineWidth <- 4
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1200, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Elevation (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1200, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Elevation (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1200, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,2), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
dev.off()
droneShot
plot(droneShot)
?lidR::plot
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(droneShot, mapview=F,
axis=F, axis=T)
plot(droneShot, mapview=F,
background="white", axis=T)
plot(droneShot, mapview=F,
bg="white", axis=T)
plot(droneShot, mapview=FALSE,
bg="white", axis=T)
plot::plot(droneShot, mapview=FALSE,
bg="white", axis=T)
base::plot(droneShot, mapview=FALSE,
bg="white", axis=T)
lidR::plot(droneShot, mapview=FALSE,
bg="white", axis=T)
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1200, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
lidR::plot(droneShot, mapview=FALSE,
bg="white", axis=T)
dev.off()
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
x=droneShot$Z)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z,
pch=19,
col=adjustcolor("black",0.5))
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z,
pch=19,
cex=0.1,
col=adjustcolor("black",0.5))
min(droneShot$Z,na.rm=T)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.1,
col=adjustcolor("black",0.5),
axes=F)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.1,
col=adjustcolor("black",0.5),
axes=F,
xpd=T)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.1,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,at=-12.5)
axis(side=2,at=-10)
?axis
axis(side=2,pos=-10)
seq(0,40,10)
axis(side=2,pos=-10, at=seq(0,40,10))
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.1,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-12, at=seq(0,40,10))
axis(side=2,pos=-13, at=seq(0,40,10))
plot(x=droneShot$Y-mean(droneShot$Y,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.1,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1200, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(x=droneShot$Y-mean(droneShot$Y,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.08,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1000, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(x=droneShot$Y-mean(droneShot$Y,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.08,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1100, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(x=droneShot$Y-mean(droneShot$Y,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.08,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1100, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,2,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.08,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
dev.off()
jpeg(filename = "Results/GEDI_example.jpeg",
width = 1800, height = 1100, units = "px", pointsize = 36,
quality = 300)
par(mar=c(3,3,1,1), oma=c(2,3,0,0), mfrow=c(1,3), las=1)
# First panel: plot wavelength from minimum to maximum values,
# Scale y-axis to height above ground value
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
xlab=NA,ylab=NA,
type = "l", lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
# Second panel: zoom in closer to min and max heights to better see waveform
plot(x = data1B_amplitudeScaled,
y = data1B_htAboveGround,
ylim=c(-10,40),
xlab=NA,ylab=NA,
type = "l",lwd=lineWidth)
# Add red lines for drone data min and 98th percentile heights
abline(h=c(min(droneShot$Z),quantile(droneShot$Z,0.98)),
lwd=lineWidth+2,col=adjustcolor("red",0.6))
# Add blue lines from GEDI ground and RH 98 values
abline(h=c(0,data_ha4_utmPoly_good$rh_98[1]),
lwd=lineWidth+2, col=adjustcolor("blue",0.6))
mtext("Scaled waveform amplitude", side=1, outer=T, cex=1.5)
mtext("Height above ground (m)", side=2, outer=T, las=0, cex=1.5, line=0.5)
plot(x=droneShot$X-mean(droneShot$X,na.rm=T),
y=droneShot$Z-min(droneShot$Z,na.rm=T),
pch=19,
cex=0.08,
col=adjustcolor("black",0.5),
axes=F,
asp=1)
axis(side=2,pos=-14, at=seq(0,40,10))
dev.off()
